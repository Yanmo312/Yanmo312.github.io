<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>AW-crypto_s_1 | Yanmo312</title><meta name="keywords" content="CTF"><meta name="author" content="Yanmo312"><meta name="copyright" content="Yanmo312"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="攻防世界-crypto一、sherlock 题目：附件下载下来，是英文原著小说，有几个大写的字母  1、知识补充用法: grep [选项]… 模式 [文件]…-E, —extended-regexp &lt;模式&gt; 是扩展正则表达式-o, —only-matching 只显示行中非空匹配部分[] #匹配一个指定范围内的字符，如’[Gg]rep’匹配Grep和grep。 用法：tr [选项]…">
<meta property="og:type" content="article">
<meta property="og:title" content="AW-crypto_s_1">
<meta property="og:url" content="https://yanmo312.github.io/2022/03/22/Crypto_2/index.html">
<meta property="og:site_name" content="Yanmo312">
<meta property="og:description" content="攻防世界-crypto一、sherlock 题目：附件下载下来，是英文原著小说，有几个大写的字母  1、知识补充用法: grep [选项]… 模式 [文件]…-E, —extended-regexp &lt;模式&gt; 是扩展正则表达式-o, —only-matching 只显示行中非空匹配部分[] #匹配一个指定范围内的字符，如’[Gg]rep’匹配Grep和grep。 用法：tr [选项]…">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yanmo312.github.io/img/default.jpg">
<meta property="article:published_time" content="2022-03-22T01:40:36.000Z">
<meta property="article:modified_time" content="2022-09-08T10:50:25.320Z">
<meta property="article:author" content="Yanmo312">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yanmo312.github.io/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://yanmo312.github.io/2022/03/22/Crypto_2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/css/font.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AW-crypto_s_1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-08 18:50:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Yanmo312</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">AW-crypto_s_1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-03-22T01:40:36.000Z" title="Created 2022-03-22 09:40:36">2022-03-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-09-08T10:50:25.320Z" title="Updated 2022-09-08 18:50:25">2022-09-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">8.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>36min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="AW-crypto_s_1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="攻防世界-crypto"><a href="#攻防世界-crypto" class="headerlink" title="攻防世界-crypto"></a>攻防世界-crypto</h1><h2 id="一、sherlock"><a href="#一、sherlock" class="headerlink" title="一、sherlock"></a>一、sherlock</h2><blockquote>
<p>题目：附件下载下来，是英文原著小说，有几个大写的字母</p>
</blockquote>
<h3 id="1、知识补充"><a href="#1、知识补充" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p><strong>用法: grep [选项]… 模式 [文件]…</strong><br>-E, —extended-regexp &lt;模式&gt; 是扩展正则表达式<br>-o, —only-matching 只显示行中非空匹配部分<br>[] #匹配一个指定范围内的字符，如’[Gg]rep’匹配Grep和grep。</p>
<p><strong>用法：tr [选项]… SET1 [SET2]</strong><br>-d, —delete delete characters in SET1, do not translate</p>
<h1 id="删除SET1中的字符，不进行翻译"><a href="#删除SET1中的字符，不进行翻译" class="headerlink" title="删除SET1中的字符，不进行翻译"></a>删除SET1中的字符，不进行翻译</h1><p>\n 换行</p>
<h3 id="2、解答"><a href="#2、解答" class="headerlink" title="2、解答"></a>2、解答</h3><p>发现有重复出现的大写字母，且找几个看似乎是<code>zero</code>和<code>one</code>的重复出现。</p>
<p>在虚拟机利用命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat 文件名 | grep -Eo &#x27;[A-Z]&#x27; |tr -d &#x27;\n&#x27;</span><br></pre></td></tr></table></figure>
<p>将大写字母提取出来，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZEROONEZEROZEROZEROZEROONEZEROZEROONEZEROZEROONEZEROZEROONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROONEZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROZEROZEROONEONEZEROZEROONEONEONEONEZEROONEONEZEROONEONEZEROONEZEROZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROZEROONEZEROZEROZEROZEROONEONEZEROZEROONEONEZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROONEONEONEZEROZEROZEROZEROZEROONEONEZEROONEONEZEROZEROZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROONEZEROONEZEROZEROONEONEZEROZEROZEROONEZEROZEROONEONEZEROONEONEONEZEROZEROONEONEZEROZEROONEONEZEROONEONEONEONEON</span><br></pre></td></tr></table></figure>
<p>把0、1回代，回代代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">key1=<span class="string">&quot;ZEROONEZEROZEROZEROZEROONEZEROZEROONEZEROZEROONEZEROZEROONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROONEZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROONEZEROONEZEROONEZEROZEROZEROONEZEROZEROZEROONEONEZEROZEROONEONEONEONEZEROONEONEZEROONEONEZEROONEZEROZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROZEROONEZEROZEROZEROZEROONEONEZEROZEROONEONEZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROONEONEONEZEROZEROZEROZEROZEROONEONEZEROONEONEZEROZEROZEROZEROONEONEZEROONEZEROZEROZEROZEROONEONEZEROZEROZEROONEZEROONEONEZEROONEONEONEZEROZEROONEZEROONEONEONEONEONEZEROZEROONEONEZEROONEZEROONEZEROZEROONEONEZEROZEROZEROONEZEROZEROONEONEZEROONEONEONEZEROZEROONEONEZEROZEROONEONEZEROONEONEONEONEONEZEROONE&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(key1):</span><br><span class="line">	<span class="keyword">if</span> key1[i]==<span class="string">&#x27;Z&#x27;</span><span class="keyword">and</span> key1[i+<span class="number">1</span>]==<span class="string">&#x27;E&#x27;</span><span class="keyword">and</span> key1[i+<span class="number">2</span>]==<span class="string">&#x27;R&#x27;</span><span class="keyword">and</span> key1[i+<span class="number">3</span>]==<span class="string">&#x27;O&#x27;</span>:</span><br><span class="line">		i+=<span class="number">4</span></span><br><span class="line">		flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">		i+=<span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">010000100100100101010100010100110100001101010100010001100111101101101000001100010110010000110011010111110011000101101110010111110111000001101100001101000011000101101110010111110011010100110001001101110011001101111101</span><br></pre></td></tr></table></figure>
<p>再二进制转化成字符串<a target="_blank" rel="noopener" href="https://www.rapidtables.org/zh-CN/convert/number/binary-to-string.html">二进制到字符串转换器 (rapidtables.org)</a></p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/1_xqbe9n.png" alt="image-20220402203534323"></p>
<p>得到结果</p>
<h3 id="3、注意"><a href="#3、注意" class="headerlink" title="3、注意"></a>3、注意</h3><p>（1）注意区分摩斯电码和二进制，摩斯电码有分割线。</p>
<p>（2）虚拟机常用命令：</p>
<p>cd /home 进入 ‘/ home’ 目录’<br>cd .. 返回上一级目录<br>cd ../.. 返回上两级目录<br>cd 进入个人的主目录<br>cd ~user1 进入个人的主目录<br>cd - 返回上次所在的目录<br>pwd 显示工作路径<br>ls 查看目录中的文件<br>ls -F 查看目录中的文件<br>ls -l 显示文件和目录的详细资料<br>ls -a 显示隐藏文件<br>ls <em>[0-9]</em> 显示包含数字的文件名和目录名<br>tree 显示文件和目录由根目录开始的树形结构<br>lstree 显示文件和目录由根目录开始的树形结构<br>mkdir dir1 创建一个叫做 ‘dir1’ 的目录’<br>mkdir dir1 dir2 同时创建两个目录<br>mkdir -p /tmp/dir1/dir2 创建一个目录树<br>rm -f file1 删除一个叫做 ‘file1’ 的文件’<br>rmdir dir1 删除一个叫做 ‘dir1’ 的目录’<br>rm -rf dir1 删除一个叫做 ‘dir1’ 的目录并同时删除其内容<br>rm -rf dir1 dir2 同时删除两个目录及它们的内容<br>mv dir1 new_dir 重命名/移动 一个目录<br>cp file1 file2 复制一个文件<br>cp dir/<em> . 复制一个目录下的所有文件到当前工作目录<br>cp -a /tmp/dir1 . 复制一个目录到当前工作目录<br>cp -a dir1 dir2 复制一个目录<br>ln -s file1 lnk1 创建一个指向文件或目录的软链接<br>ln file1 lnk1 创建一个指向文件或目录的物理链接<br>touch -t 0712250000 file1 修改一个文件或目录的时间戳 - (YYMMDDhhmm)<br>file file1 outputs the mime type of the file as text<br>iconv -l 列出已知的编码<br>iconv -f fromEncoding -t toEncoding inputFile &gt; outputFile creates a new from the given input file by assuming it is encoded in fromEncoding and converting it to toEncoding.<br>find . -maxdepth 1 -name </em>.jpg -print -exec convert “{}” -resize 80x60 “thumbs/{}” \; batch resize files in the current directory and send them to a thumbnails directory (requires convert from Imagemagick) </p>
<p><strong>文件搜索</strong><br>find / -name file1 从 ‘/‘ 开始进入根文件系统搜索文件和目录<br>find / -user user1 搜索属于用户 ‘user1’ 的文件和目录<br>find /home/user1 -name *.bin 在目录 ‘/ home/user1’ 中搜索带有’.bin’ 结尾的文件<br>find /usr/bin -type f -atime +100 搜索在过去100天内未被使用过的执行文件<br>find /usr/bin -type f -mtime -10 搜索在10天内被创建或者修改过的文件<br>find / -name *.rpm -exec chmod 755 ‘{}’ \; 搜索以 ‘.rpm’ 结尾的文件并定义其权限<br>find / -xdev -name *.rpm 搜索以 ‘.rpm’ 结尾的文件，忽略光驱、捷盘等可移动设备<br>locate *.ps 寻找以 ‘.ps’ 结尾的文件 - 先运行 ‘updatedb’ 命令<br>whereis halt 显示一个二进制文件、源码或man的位置<br>which halt 显示一个二进制文件或可执行文件的完整路径 </p>
<p><strong>打包和压缩文件</strong><br>bunzip2 file1.bz2 解压一个叫做 ‘file1.bz2’的文件<br>bzip2 file1 压缩一个叫做 ‘file1’ 的文件<br>gunzip file1.gz 解压一个叫做 ‘file1.gz’的文件<br>gzip file1 压缩一个叫做 ‘file1’的文件<br>gzip -9 file1 最大程度压缩<br>rar a file1.rar test_file 创建一个叫做 ‘file1.rar’ 的包<br>rar a file1.rar file1 file2 dir1 同时压缩 ‘file1’, ‘file2’ 以及目录 ‘dir1’<br>unrar x file1.rar 解压rar包<br>tar -cvf archive.tar file1 创建一个非压缩的 tarball<br>tar -cvf archive.tar file1 file2 dir1 创建一个包含了 ‘file1’, ‘file2’ 以及 ‘dir1’的档案文件<br>tar -tf archive.tar 显示一个包中的内容<br>tar -xvf archive.tar 释放一个包<br>tar -xvf archive.tar -C /tmp 将压缩包释放到 /tmp目录下<br>tar -cvfj archive.tar.bz2 dir1 创建一个bzip2格式的压缩包<br>tar -jxvf archive.tar.bz2 解压一个bzip2格式的压缩包<br>tar -cvfz archive.tar.gz dir1 创建一个gzip格式的压缩包<br>tar -zxvf archive.tar.gz 解压一个gzip格式的压缩包<br>zip file1.zip file1 创建一个zip格式的压缩包<br>zip -r file1.zip file1 file2 dir1 将几个文件和目录同时压缩成一个zip格式的压缩包<br>unzip file1.zip 解压一个zip格式压缩包 </p>
<p><strong>查看文件内容</strong><br>cat file1 从第一个字节开始正向查看文件的内容<br>tac file1 从最后一行开始反向查看一个文件的内容<br>more file1 查看一个长文件的内容<br>less file1 类似于 ‘more’ 命令，但是它允许在文件中和正向操作一样的反向操作<br>head -2 file1 查看一个文件的前两行<br>tail -2 file1 查看一个文件的最后两行<br>tail -f /var/log/messages 实时查看被添加到一个文件中的内容 </p>
<p><strong>文本处理</strong><br>cat file1 file2 … | command &lt;&gt; file1_in.txt_or_file1_out.txt general syntax for text manipulation using PIPE, STDIN and STDOUT<br>cat file1 | command( sed, grep, awk, grep, etc…) &gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个新文件中<br>cat file1 | command( sed, grep, awk, grep, etc…) &gt;&gt; result.txt 合并一个文件的详细说明文本，并将简介写入一个已有的文件中<br>grep Aug /var/log/messages 在文件 ‘/var/log/messages’中查找关键词”Aug”<br>grep ^Aug /var/log/messages 在文件 ‘/var/log/messages’中查找以”Aug”开始的词汇<br>grep [0-9] /var/log/messages 选择 ‘/var/log/messages’ 文件中所有包含数字的行<br>grep Aug -R /var/log/<em> 在目录 ‘/var/log’ 及随后的目录中搜索字符串”Aug”<br>sed ‘s/stringa1/stringa2/g’ example.txt 将example.txt文件中的 “string1” 替换成 “string2”<br>sed ‘/^/d’ example.txt 从example.txt文件中删除所有空白行<br>sed ‘/ </em>#/d; /^/d’ example.txt 从example.txt文件中删除所有注释和空白行<br>echo ‘esempio’ | tr ‘[:lower:]’ ‘[:upper:]’ 合并上下单元格内容<br>sed -e ‘1d’ result.txt 从文件example.txt 中排除第一行<br>sed -n ‘/stringa1/p’ 查看只包含词汇 “string1”的行<br>sed -e ‘s/ <em>$//‘ example.txt 删除每一行最后的空白字符<br>sed -e ‘s/stringa1//g’ example.txt 从文档中只删除词汇 “string1” 并保留剩余全部<br>sed -n ‘1,5p;5q’ example.txt 查看从第一行到第5行内容<br>sed -n ‘5p;5q’ example.txt 查看第5行<br>sed -e ‘s/00</em>/0/g’ example.txt 用单个零替换多个零<br>cat -n file1 标示文件的行数<br>cat example.txt | awk ‘NR%2==1’ 删除example.txt文件中的所有偶数行<br>echo a b c | awk ‘{print 1}’ 查看一行第一栏<br>echo a b c | awk ‘{print 1,3}’ 查看一行的第一和第三栏<br>paste file1 file2 合并两个文件或两栏的内容<br>paste -d ‘+’ file1 file2 合并两个文件或两栏的内容，中间用”+”区分<br>sort file1 file2 排序两个文件的内容<br>sort file1 file2 | uniq 取出两个文件的并集(重复的行只保留一份)<br>sort file1 file2 | uniq -u 删除交集，留下其他的行<br>sort file1 file2 | uniq -d 取出两个文件的交集(只留下同时存在于两个文件中的文件)<br>comm -1 file1 file2 比较两个文件的内容只删除 ‘file1’ 所包含的内容<br>comm -2 file1 file2 比较两个文件的内容只删除 ‘file2’ 所包含的内容<br>comm -3 file1 file2 比较两个文件的内容只删除两个文件共有的部分 </p>
<p>参考:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yjd_hycf_space/p/7730690.html">Linux常用命令大全（非常全！！！） - fcyh - 博客园 (cnblogs.com)</a></p>
<h2 id="二、flag-in-your-hand"><a href="#二、flag-in-your-hand" class="headerlink" title="二、flag_in_your_hand"></a>二、flag_in_your_hand</h2><blockquote>
<p>题目：解压文件后有一个html页面，和一个javascript源文件</p>
</blockquote>
<h3 id="1、知识补充-1"><a href="#1、知识补充-1" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-1"><a href="#2、解答-1" class="headerlink" title="2、解答"></a>2、解答</h3><p>进入网页，发现只有ic=true才可以出现flag</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/2_bo1zve.png" alt="image-20220402204526440"></p>
<p>查看源码，看到和ic相关的源码，和一串疑似token的数组</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/3_c7vq7c.png" alt="image-20220402204632263"></p>
<p>则a数组的每一个元素减去3，再转换成对应的字符，就可以得到token的值，使得ic=true</p>
<p>以下为转换代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">118</span>, <span class="number">104</span>, <span class="number">102</span>, <span class="number">120</span>, <span class="number">117</span>, <span class="number">108</span>, <span class="number">119</span>, <span class="number">124</span>, <span class="number">48</span>, <span class="number">123</span>, <span class="number">101</span>, <span class="number">120</span>]</span><br><span class="line">s=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">	s+=<span class="built_in">chr</span>(i-<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<p>得到token:security-xbu</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/4_miwg8s.png" alt="image-20220402204932862"></p>
<h3 id="3、注意-1"><a href="#3、注意-1" class="headerlink" title="3、注意"></a>3、注意</h3><p>注意查看网页源码，关注疑似密码数字或字符串</p>
<h2 id="三、告诉你个秘密"><a href="#三、告诉你个秘密" class="headerlink" title="三、告诉你个秘密"></a>三、告诉你个秘密</h2><blockquote>
<p>题目：下载附件，是两串数</p>
</blockquote>
<h3 id="1、知识补充-2"><a href="#1、知识补充-2" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-2"><a href="#2、解答-2" class="headerlink" title="2、解答"></a>2、解答</h3><p>打开是两串16进制</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">636A56355279427363446C4A49454A7154534230526D6843</span><br><span class="line">56445A31614342354E326C4B4946467A5769426961453067</span><br></pre></td></tr></table></figure>
<p>16进制转换ASCII</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cjV5RyBscDlJIEJqTSB0RmhCVDZ1aCB5N2lKIFFzWiBiaE0g</span><br></pre></td></tr></table></figure>
<p>很明显是base64加密，再解密得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r5yG lp9I BjM tFhBT6uh y7iJ QsZ bhM </span><br></pre></td></tr></table></figure>
<p>一开始不知道这是个啥，查资料后，原来是按键盘上的分布，每四个包着一个按键，把每个包的中间的输出并大写即得到答案</p>
<h3 id="3、注意-2"><a href="#3、注意-2" class="headerlink" title="3、注意"></a>3、注意</h3><p>注意一些奇奇怪怪的解答方式（）</p>
<h2 id="四、你猜猜"><a href="#四、你猜猜" class="headerlink" title="四、你猜猜"></a>四、你猜猜</h2><blockquote>
<p>题目：我们刚刚拦截了，敌军的文件传输获取一份机密文件，请君速速破解。</p>
</blockquote>
<h3 id="1、知识补充-3"><a href="#1、知识补充-3" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>利用文件开头判断文件类型：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/senior-engineer/p/9541719.html">利用文件头标志判断文件类型 - maxiongying - 博客园 (cnblogs.com)</a></p>
<p>判断zip文件加密真伪：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42667177/article/details/116646338">(1条消息) 判断zip文件加密的真假_心bor的博客-CSDN博客</a></p>
<p>关于伪加密：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42667177/article/details/116646338">(1条消息) 判断zip文件加密的真假_心bor的博客-CSDN博客</a></p>
<h3 id="2、解答-3"><a href="#2、解答-3" class="headerlink" title="2、解答"></a>2、解答</h3><p>文件下载下来是一串看起来像16进制的数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504B03040A0001080000626D0A49F4B5091F1E0000001200000008000000666C61672E7478746C9F170D35D0A45826A03E161FB96870EDDFC7C89A11862F9199B4CD78E7504B01023F000A0001080000626D0A49F4B5091F1E00000012000000080024000000000000002000000000000000666C61672E7478740A0020000000000001001800AF150210CAF2D1015CAEAA05CAF2D1015CAEAA05CAF2D101504B050600000000010001005A000000440000000000</span><br></pre></td></tr></table></figure>
<p>送到16进制转ASCII解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PK</span><br><span class="line">bm</span><br><span class="line">Iôµ	flag.txtl</span><br><span class="line">5Ð¤X&amp; &gt;¹hpíßÇÈ/´ÍxçPK?</span><br><span class="line">bm</span><br><span class="line">Iôµ	$ flag.txt</span><br><span class="line"> ¯ÊòÑ\®ªÊòÑ\®ªÊòÑPKZD</span><br></pre></td></tr></table></figure>
<p>一堆乱码，但看到了<code>flag.txt</code>，结合开头504B0304，猜测这是一个zip的二进制数据</p>
<p><strong>此时判断该zip是真加密还是假加密：</strong></p>
<p>1.压缩源文件目录区的标记第二位是奇数：01 08</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/5_lhsnfl.png" alt="img"></p>
<p>2.压缩源文件数据区标记第二位是奇数：01 08</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633870/my_blog/CTF/Crypto_attackworld_s_1/6_oul6oi.png" alt="img"></p>
<p>尝试将其修改为偶数失败，真加密实锤了。</p>
<p>打开winhex64复制粘贴成zip文件，但打开时显示文件已破损，修复后，需要解密密码才可以看到flag，利用Ziperello穷举解密，得到密码123456，于是得到flag</p>
<h3 id="3、注意-3"><a href="#3、注意-3" class="headerlink" title="3、注意"></a>3、注意</h3><p>识别文件头，巧用Ziperello减少穷举时间</p>
<h2 id="五、Broadcast"><a href="#五、Broadcast" class="headerlink" title="五、Broadcast"></a>五、Broadcast</h2><blockquote>
<p>题目：粗心的Alice在制作密码的时候，把明文留下来，聪明的你能快速找出来吗？</p>
</blockquote>
<h3 id="1、知识补充-4"><a href="#1、知识补充-4" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-4"><a href="#2、解答-4" class="headerlink" title="2、解答"></a>2、解答</h3><p>打开附件task.py文件，果然答案就在里面</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633871/my_blog/CTF/Crypto_attackworld_s_1/7_vbcl5h.png" alt="image-20220402211204336"></p>
<h3 id="3、注意-4"><a href="#3、注意-4" class="headerlink" title="3、注意"></a>3、注意</h3><p>暂无</p>
<h2 id="六、工业协议分析2"><a href="#六、工业协议分析2" class="headerlink" title="六、工业协议分析2"></a>六、工业协议分析2</h2><blockquote>
<p>题目：在进行工业企业检查评估工作中，发现了疑似感染恶意软件的上位机。现已提取出上位机通信流量，尝试分析出异常点，获取FLAG。 flag形式为 flag{}</p>
</blockquote>
<h3 id="1、知识补充-5"><a href="#1、知识补充-5" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-5"><a href="#2、解答-5" class="headerlink" title="2、解答"></a>2、解答</h3><p>下载下来是个PCAPNG文件，拖到虚拟机去，查看文件长度，发现大部分重复，极个别单独出现一次</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633872/my_blog/CTF/Crypto_attackworld_s_1/8_i2egby.png" alt="image-20220402212027903"></p>
<p>找到一处带有一串字符的，复制下来，发现最大不超过f，猜测是16进制，将其转成字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">666c61677b37466f4d3253746b6865507a7d</span><br><span class="line">flag&#123;7FoM2StkhePz&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3、注意-5"><a href="#3、注意-5" class="headerlink" title="3、注意"></a>3、注意</h3><p>查找时可关注文件大小、长度</p>
<h2 id="七、cr3-what-is-this-encryption"><a href="#七、cr3-what-is-this-encryption" class="headerlink" title="七、cr3-what-is-this-encryption"></a>七、cr3-what-is-this-encryption</h2><blockquote>
<p>题目：Fady同学以为你是菜鸟，不怕你看到他发的东西。他以明文形式将下面这些东西发给了他的朋友 p=0xa6055ec186de51800ddd6fcbf0192384ff42d707a55f57af4fcfb0d1dc7bd97055e8275cd4b78ec63c5d592f567c66393a061324aa2e6a8d8fc2a910cbee1ed9 q=0xfa0f9463ea0a93b929c099320d31c277e0b0dbc65b189ed76124f5a1218f5d91fd0102a4c8de11f28be5e4d0ae91ab319f4537e97ed74bc663e972a4a9119307 e=0x6d1fdab4ce3217b3fc32c9ed480a31d067fd57d93a9ab52b472dc393ab7852fbcb11abbebfd6aaae8032db1316dc22d3f7c3d631e24df13ef23d3b381a1c3e04abcc745d402ee3a031ac2718fae63b240837b4f657f29ca4702da9af22a3a019d68904a969ddb01bcf941df70af042f4fae5cbeb9c2151b324f387e525094c41 c=0x7fe1a4f743675d1987d25d38111fae0f78bbea6852cba5beda47db76d119a3efe24cb04b9449f53becd43b0b46e269826a983f832abb53b7a7e24a43ad15378344ed5c20f51e268186d24c76050c1e73647523bd5f91d9b6ad3e86bbf9126588b1dee21e6997372e36c3e74284734748891829665086e0dc523ed23c386bb520 他严重低估了我们的解密能力</p>
</blockquote>
<h3 id="1、知识补充-6"><a href="#1、知识补充-6" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-6"><a href="#2、解答-6" class="headerlink" title="2、解答"></a>2、解答</h3><p>有p,q,e,n,c，就是RSA，可以用虚拟机的工具，也可用脚本，这次用代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">q = <span class="built_in">int</span>(<span class="string">&quot;0xa6055ec186de51800ddd6fcbf0192384ff42d707a55f57af4fcfb0d1dc7bd97055e8275cd4b78ec63c5d592f567c66393a061324aa2e6a8d8fc2a910cbee1ed9&quot;</span>,<span class="number">16</span>)</span><br><span class="line">p = <span class="built_in">int</span>(<span class="string">&quot;0xfa0f9463ea0a93b929c099320d31c277e0b0dbc65b189ed76124f5a1218f5d91fd0102a4c8de11f28be5e4d0ae91ab319f4537e97ed74bc663e972a4a9119307&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="built_in">int</span>(<span class="string">&quot;0x6d1fdab4ce3217b3fc32c9ed480a31d067fd57d93a9ab52b472dc393ab7852fbcb11abbebfd6aaae8032db1316dc22d3f7c3d631e24df13ef23d3b381a1c3e04abcc745d402ee3a031ac2718fae63b240837b4f657f29ca4702da9af22a3a019d68904a969ddb01bcf941df70af042f4fae5cbeb9c2151b324f387e525094c41&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">int</span>(<span class="string">&quot;0x7fe1a4f743675d1987d25d38111fae0f78bbea6852cba5beda47db76d119a3efe24cb04b9449f53becd43b0b46e269826a983f832abb53b7a7e24a43ad15378344ed5c20f51e268186d24c76050c1e73647523bd5f91d9b6ad3e86bbf9126588b1dee21e6997372e36c3e74284734748891829665086e0dc523ed23c386bb520&quot;</span>,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">n = q*p</span><br><span class="line"> </span><br><span class="line">d = libnum.invmod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)  </span><br><span class="line">string = long_to_bytes(m)  </span><br><span class="line"><span class="built_in">print</span>(string)</span><br></pre></td></tr></table></figure>
<p>得到答案</p>
<h3 id="3、注意-6"><a href="#3、注意-6" class="headerlink" title="3、注意"></a>3、注意</h3><p>先把16进制转化成10进制在计算</p>
<h2 id="八、banana-princess"><a href="#八、banana-princess" class="headerlink" title="八、banana-princess"></a>八、banana-princess</h2><blockquote>
<p>题目：下载下来是个损坏的pdf</p>
</blockquote>
<h3 id="1、知识补充-7"><a href="#1、知识补充-7" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>损坏的pdf试着使用notepad++打开</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633871/my_blog/CTF/Crypto_attackworld_s_1/9_akakw3.png" alt="image-20220405130216794"></p>
<p>看不出什么，再打开一个正常的pdf对比，发现开头就不一样</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">这个</th>
<th style="text-align:center">正常</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">%CQS-1.5</td>
<td style="text-align:center">%PDF-1.7</td>
</tr>
</tbody>
</table>
</div>
<p>感觉像是进行了移位</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633871/my_blog/CTF/Crypto_attackworld_s_1/10_ghbvk2.png" alt="image-20220405130728935"></p>
<p>确实是移位，还是13，想到rot13</p>
<p>再随机找个字符测试</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633871/my_blog/CTF/Crypto_attackworld_s_1/11_dtikwx.png" alt="image-20220405130840940"></p>
<p>对整个pdf进行rot解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat 9e45191069704531accd66f1ee1d5b2b.pdf | tr &#x27;A-Za-z&#x27; &#x27;N-ZA-Mn-za-m&#x27; &gt; new.pdf</span><br></pre></td></tr></table></figure>
<p>得到flag被挡住的图片，使用pdftohtml命令转化图片，得到结果</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633874/my_blog/CTF/Crypto_attackworld_s_1/12_kwf0do.png" alt="image-20220405131640000"></p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633873/my_blog/CTF/Crypto_attackworld_s_1/13_qqo4ie.png" alt="image-20220405131701560"></p>
<h2 id="九、flag-in-your-hand1"><a href="#九、flag-in-your-hand1" class="headerlink" title="九、flag_in_your_hand1"></a>九、flag_in_your_hand1</h2><blockquote>
<p>题目重了，见二</p>
</blockquote>
<h2 id="十、Decrypt-the-Message"><a href="#十、Decrypt-the-Message" class="headerlink" title="十、Decrypt-the-Message"></a>十、Decrypt-the-Message</h2><blockquote>
<p>题目：解密这段信息！</p>
<p>The life that I have<br>Is all that I have<br>And the life that I have<br>Is yours.</p>
<p>The love that I have<br>Of the life that I have<br>Is yours and yours and yours.</p>
<p>A sleep I shall have<br>A rest I shall have<br>Yet death will be but a pause.</p>
<p>For the peace of my years<br>In the long green grass<br>Will be yours and yours and yours.</p>
<p>decrypted message: emzcf sebt yuwi ytrr ortl rbon aluo konf ihye cyog rowh prhj feom ihos perp twnb tpak heoc yaui usoa irtd tnlu ntke onds goym hmpq</p>
</blockquote>
<h3 id="1、知识补充-8"><a href="#1、知识补充-8" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>① 给出一首诗歌</p>
<blockquote>
<p>for my purpose holds to sail beyond the sunset, and the baths of all the western stars until I die.</p>
</blockquote>
<p>② 给出5个关键单词。</p>
<blockquote>
<p>“for”, “sail”, “all”, “stars”, “die.”</p>
</blockquote>
<p>对其进行拆散：</p>
<blockquote>
<p>f o r s a i l a l l s t a r s d i e</p>
</blockquote>
<p>接下来按照 字母表顺序 进行编号，若遇相同字母，则继续 +1</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">f</th>
<th style="text-align:center">o</th>
<th style="text-align:center">r</th>
<th style="text-align:center">s</th>
<th style="text-align:center">a</th>
<th style="text-align:center">i</th>
<th style="text-align:center">l</th>
<th style="text-align:center">a</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">12</td>
<td style="text-align:center">13</td>
<td style="text-align:center">15</td>
<td style="text-align:center">1</td>
<td style="text-align:center">7</td>
<td style="text-align:center">9</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center"><strong>l</strong></td>
<td style="text-align:center"><strong>l</strong></td>
<td style="text-align:center"><strong>s</strong></td>
<td style="text-align:center"><strong>t</strong></td>
<td style="text-align:center"><strong>r</strong></td>
<td style="text-align:center"><strong>r</strong></td>
<td style="text-align:center"><strong>s</strong></td>
<td style="text-align:center"><strong>d</strong></td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">11</td>
<td style="text-align:center">16</td>
<td style="text-align:center">18</td>
<td style="text-align:center">14</td>
<td style="text-align:center">14</td>
<td style="text-align:center">17</td>
<td style="text-align:center">4</td>
</tr>
<tr>
<td style="text-align:center"><strong>i</strong></td>
<td style="text-align:center"><strong>e</strong></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">5</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<p>③ 将要传递的消息进行加密。</p>
<blockquote>
<p>We have run out of cigars, situation desperate。</p>
</blockquote>
<p>先对对其进行编码。因为给出的5个关键词，其长度为18.所以以18为一组。</p>
<p>若一组长度不满18，则用abc(不要求有序)进行补充。</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633872/my_blog/CTF/Crypto_attackworld_s_1/14_guwqaw.png" alt></p>
<p>将排好的消息，按照之前给出的诗歌字母编号写下密文。</p>
<blockquote>
<p>for my purpose holds to sail beyond the sunset, and the baths of all the western stars until I die.</p>
</blockquote>
<p>如， for —&gt; eud tdk oek 那么得到的又可以按照5个（适当个数）为一组进行重新分组，得到最后密文。</p>
<p>参考：<a target="_blank" rel="noopener" href="http://www.wmbriggs.com/post/1001/">Poem Codes – William M. Briggs (wmbriggs.com)</a></p>
<h3 id="2、解答-7"><a href="#2、解答-7" class="headerlink" title="2、解答"></a>2、解答</h3><p>先将诗歌和信息分开存成文本，把标点去掉，和以下代码放在同一文件夹下，运行代码(虚拟机)即得到代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> listdir</span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> isfile, join</span><br><span class="line"></span><br><span class="line">abc=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">loadlist</span>(<span class="params">infile</span>):</span><br><span class="line">	tlist = []</span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(infile,<span class="string">&#x27;r&#x27;</span>):</span><br><span class="line">		<span class="keyword">for</span> w <span class="keyword">in</span> line.split(): tlist.append(w.lower())</span><br><span class="line">	<span class="keyword">return</span> tlist</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">code, poem, msg</span>):</span><br><span class="line">	<span class="comment"># Load all words of the poem into a temporary list</span></span><br><span class="line">	twords = loadlist(poem)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Select only those words specified in the code in a new list</span></span><br><span class="line">	pwords = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> code: pwords += twords[c].lower()</span><br><span class="line">	plen = <span class="built_in">len</span>(pwords)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># We can only support encoding all alphabetical letters, a key length greater len(abc) is not reasonable here</span></span><br><span class="line">	<span class="keyword">if</span> plen &gt; <span class="built_in">len</span>(abc): sys.exit(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Assign an index for each letter in the key based on the alphabet</span></span><br><span class="line">	pcode = [<span class="literal">None</span>] * plen</span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span>(count&lt;plen):</span><br><span class="line">		<span class="keyword">for</span> al <span class="keyword">in</span> abc:</span><br><span class="line">			<span class="keyword">for</span> pc, pl <span class="keyword">in</span> <span class="built_in">enumerate</span>(pwords):</span><br><span class="line">				<span class="keyword">if</span> al!=pl: <span class="keyword">continue</span></span><br><span class="line">				pcode[pc]=count</span><br><span class="line">				count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># Load all words of the message into a string</span></span><br><span class="line">	mwords = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(msg, <span class="string">&#x27;r&#x27;</span>):</span><br><span class="line">		<span class="keyword">for</span> w <span class="keyword">in</span> line.split(): mwords+=w.lower()</span><br><span class="line">	mlen = <span class="built_in">len</span>(mwords)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Split message into chunks of size plen, append random (here alphabet) characters to fill the last chunk, if necessary</span></span><br><span class="line">	cpairs = []</span><br><span class="line">	curlen = plen</span><br><span class="line">	<span class="keyword">while</span>(curlen&lt;mlen):</span><br><span class="line">		cpairs.append(mwords[curlen-plen:curlen])</span><br><span class="line">		curlen+=plen</span><br><span class="line">	rword = mwords[curlen-plen:curlen]</span><br><span class="line">	rlen = <span class="built_in">len</span>(rword)</span><br><span class="line">	<span class="keyword">if</span> rlen &lt; plen: rword += abc[:plen-rlen]</span><br><span class="line">	cpairs.append(rword)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Encrypt the message according to the key</span></span><br><span class="line">	cip = <span class="string">&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> code: cip+=abc[i]</span><br><span class="line">	cip+=<span class="string">&#x27; &#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> pcode:</span><br><span class="line">		<span class="keyword">for</span> pair <span class="keyword">in</span> cpairs:</span><br><span class="line">			cip += pair[i]</span><br><span class="line">		cip+=<span class="string">&#x27; &#x27;</span></span><br><span class="line">	<span class="keyword">return</span> cip</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">poem, cip</span>):</span><br><span class="line">	<span class="comment"># Load all words of the poem into a temporary list</span></span><br><span class="line">	twords = loadlist(poem)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Load all cipher chunks of the ciphertext into a list</span></span><br><span class="line">	cwords = loadlist(cip)</span><br><span class="line"></span><br><span class="line">	<span class="comment"># Get the code rom the first chunk and remove it from the ciphertext list</span></span><br><span class="line">	code = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> cwords.pop(<span class="number">0</span>):</span><br><span class="line">		code.append(abc.index(i))</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># Select only those words specified in the code in a new multi-arrayed list</span></span><br><span class="line">	xwords = [[] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code))]</span><br><span class="line">	<span class="keyword">for</span> xcount, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(code):</span><br><span class="line">		tlen = c</span><br><span class="line">		<span class="keyword">while</span>(c&lt;<span class="built_in">len</span>(twords)):</span><br><span class="line">			xwords[xcount].append(twords[c].lower())</span><br><span class="line">			c+=<span class="number">26</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># Get all possible combinations</span></span><br><span class="line">	<span class="keyword">for</span> comb <span class="keyword">in</span> itertools.product(*xwords):</span><br><span class="line">		pwords = <span class="string">&#x27;&#x27;</span></span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> comb: pwords+=c</span><br><span class="line">		plen = <span class="built_in">len</span>(pwords)</span><br><span class="line"></span><br><span class="line">		<span class="comment"># Rearrange the chunks according to the key</span></span><br><span class="line">		pcode = [<span class="literal">None</span>] * plen</span><br><span class="line">		count = <span class="number">0</span></span><br><span class="line">		<span class="keyword">while</span>(count&lt;plen):</span><br><span class="line">			<span class="keyword">for</span> al <span class="keyword">in</span> abc:</span><br><span class="line">				<span class="keyword">for</span> pc, pl <span class="keyword">in</span> <span class="built_in">enumerate</span>(pwords):</span><br><span class="line">					<span class="keyword">if</span> al!=pl: <span class="keyword">continue</span></span><br><span class="line">					pcode[count]=cwords[pc]</span><br><span class="line">					count+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">		<span class="comment"># Decrypt the ciphertext</span></span><br><span class="line">		msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">		wlen = <span class="built_in">len</span>(pcode[<span class="number">0</span>])</span><br><span class="line">		<span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, wlen):</span><br><span class="line">			<span class="keyword">for</span> word <span class="keyword">in</span> pcode:</span><br><span class="line">				msg+=word[c]</span><br><span class="line">		<span class="built_in">print</span> (msg)</span><br><span class="line"></span><br><span class="line"><span class="comment"># first argument = poem</span></span><br><span class="line"><span class="comment"># second argument = ciphertxt or msg</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">    sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print encrypt([0, 5, 13, 16, 19], sys.argv[1], sys.argv[2])</span></span><br><span class="line">decrypt(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<p>得到答案</p>
<h3 id="3、注意-7"><a href="#3、注意-7" class="headerlink" title="3、注意"></a>3、注意</h3><p>对于诗歌加密的理解</p>
<h2 id="十一、OldDriver"><a href="#十一、OldDriver" class="headerlink" title="十一、OldDriver"></a>十一、OldDriver</h2><blockquote>
<p>题目：有个年轻人得到了一份密文，身为老司机的你能帮他看看么？</p>
<p>[{“c”: 7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042, “e”: 10, “n”: 25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803},<br>{“c”: 21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461, “e”: 10, “n”: 23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193},<br>{“c”: 6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983, “e”: 10, “n”: 18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623},<br>{“c”: 4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052, “e”: 10, “n”: 23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723},<br>{“c”: 22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672, “e”: 10, “n”: 31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493},<br>{“c”: 17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087, “e”: 10, “n”: 22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949},<br>{“c”: 1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639, “e”: 10, “n”: 25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043},<br>{“c”: 15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352, “e”: 10, “n”: 32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047},<br>{“c”: 8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797, “e”: 10, “n”: 52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553},<br>{“c”: 13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247, “e”: 10, “n”: 30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621}]</p>
</blockquote>
<h3 id="1、知识补充-9"><a href="#1、知识补充-9" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p><strong>低加密指数广播攻击特点：</strong></p>
<p>（1）加密指数e非常小<br>（2）一份明文使用不同的模数n，相同的加密指数e进行多次加密<br>（3）可以拿到每一份加密后的密文和对应的模数n、加密指数e</p>
<p><strong>识别：n非常大,e一般很小。</strong></p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dda528239554">CTF中RSA攻击方法总结 - 简书 (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/GH-D/p/11544589.html">ctf中rsa攻击方法 - 11223326 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/shuaicenglou3032/article/details/119930783">CTF中的RSA套路之低加密指数攻击攻击和低解密指数攻击<em>KogRow的博客-CSDN博客</em>低加密指数攻击</a></p>
<h3 id="2、解答-8"><a href="#2、解答-8" class="headerlink" title="2、解答"></a>2、解答</h3><p>直接套用代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">c1=gmpy2.mpz(<span class="number">7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042</span>)</span><br><span class="line">n1=gmpy2.mpz(<span class="number">25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803</span>)</span><br><span class="line">c2=gmpy2.mpz(<span class="number">21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461</span>)</span><br><span class="line">n2=gmpy2.mpz(<span class="number">23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193</span>)</span><br><span class="line">c3=gmpy2.mpz(<span class="number">6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983</span>)</span><br><span class="line">n3=gmpy2.mpz(<span class="number">18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623</span>)</span><br><span class="line">c4=gmpy2.mpz(<span class="number">4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052</span>)</span><br><span class="line">n4=gmpy2.mpz(<span class="number">23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723</span>)</span><br><span class="line">c5=gmpy2.mpz(<span class="number">22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672</span>)</span><br><span class="line">n5=gmpy2.mpz(<span class="number">31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493</span>)</span><br><span class="line">c6=gmpy2.mpz(<span class="number">17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087</span>)</span><br><span class="line">n6=gmpy2.mpz(<span class="number">22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949</span>)</span><br><span class="line">c7=gmpy2.mpz(<span class="number">1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639</span>)</span><br><span class="line">n7=gmpy2.mpz(<span class="number">25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043</span>)</span><br><span class="line">c8=gmpy2.mpz(<span class="number">15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352</span>)</span><br><span class="line">n8=gmpy2.mpz(<span class="number">32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047</span>)</span><br><span class="line">c9=gmpy2.mpz(<span class="number">8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797</span>)</span><br><span class="line">n9=gmpy2.mpz(<span class="number">52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553</span>)</span><br><span class="line">c0=gmpy2.mpz(<span class="number">13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247</span>)</span><br><span class="line">n0=gmpy2.mpz(<span class="number">30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621</span>)</span><br><span class="line">e=<span class="number">10</span></span><br><span class="line">M = n1*n2*n3*n4*n5*n6*n7*n8*n9*n0</span><br><span class="line">m1 = M//n1</span><br><span class="line">m2 = M//n2</span><br><span class="line">m3 = M//n3</span><br><span class="line">m4 = M//n4</span><br><span class="line">m5 = M//n5</span><br><span class="line">m6 = M//n6</span><br><span class="line">m7 = M//n7</span><br><span class="line">m8 = M//n8</span><br><span class="line">m9 = M//n9</span><br><span class="line">m0 = M//n0</span><br><span class="line">t1 = c1*m1*gmpy2.invert(m1,n1)</span><br><span class="line">t2 = c2*m2*gmpy2.invert(m2,n2)</span><br><span class="line">t3 = c3*m3*gmpy2.invert(m3,n3)</span><br><span class="line">t4 = c4*m4*gmpy2.invert(m4,n4)</span><br><span class="line">t5 = c5*m5*gmpy2.invert(m5,n5)</span><br><span class="line">t6 = c6*m6*gmpy2.invert(m6,n6)</span><br><span class="line">t7 = c7*m7*gmpy2.invert(m7,n7)</span><br><span class="line">t8 = c8*m8*gmpy2.invert(m8,n8)</span><br><span class="line">t9 = c9*m9*gmpy2.invert(m9,n9)</span><br><span class="line">t0 = c0*m0*gmpy2.invert(m0,n0)</span><br><span class="line">x = (t1+t2+t3+t4+t5+t6+t7+t8+t9+t0) % M</span><br><span class="line">m=gmpy2.iroot(x,e)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">m1=<span class="number">854589733786598088127099154138504953368140761371523704656865879247874533963639770706597129057405</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m1))</span><br><span class="line">m2=<span class="number">0x666c61677b776f305f7468335f747234696e5f69355f6c656176316e675f6733745f6f6e5f69747d</span></span><br><span class="line">flag=libnum.n2s(m2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="3、注意-8"><a href="#3、注意-8" class="headerlink" title="3、注意"></a>3、注意</h3><p>总结学习几种rsa加密方法</p>
<h2 id="十二、best-rsa"><a href="#十二、best-rsa" class="headerlink" title="十二、best_rsa"></a>十二、best_rsa</h2><blockquote>
<p>题目：解压后两个cipher文件两个publickey文件</p>
</blockquote>
<h3 id="1、知识补充-10"><a href="#1、知识补充-10" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>给出了2个公钥文件和和2个密文文件，用常规的RSA解密方式分别解密，解密失败（n为2048位难以分解）</p>
<p>猜想应该是同一个明文，使用了2个不同的公钥加密得到了不同的密文，对同一明文的多次加密使用相同的模数和不同的公钥指数可能导致<strong>共模攻击</strong></p>
<p><strong>共模攻击适用情况：</strong></p>
<p>明文m、模数n相同，公钥指数e、密文c不同，gcd(e1,e2)==1也就是e1和e2互质</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/serendipity1130/article/details/120154534">【密码学RSA】共模攻击原理详解<em>已知e1*e2的共模攻击题_malloc</em>冲！的博客-CSDN博客_rsa共模攻击</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/gwind/p/8013154.html">RSA的共模攻击 - gwind - 博客园 (cnblogs.com)</a></p>
<h3 id="2、解答-9"><a href="#2、解答-9" class="headerlink" title="2、解答"></a>2、解答</h3><p>使用脚本，把四个文件和脚本放到一起，运行的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> g, x - (b // a) * y, y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;publickey1.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f1 = f.read()</span><br><span class="line">pub1 = RSA.importKey(f1)</span><br><span class="line"><span class="comment"># 拿到共模数</span></span><br><span class="line">n = <span class="built_in">int</span>(pub1.n)</span><br><span class="line"><span class="comment"># 拿到公钥e1</span></span><br><span class="line">e1 = <span class="built_in">int</span>(pub1.e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;publickey2.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f2 = f.read()</span><br><span class="line">pub2 = RSA.importKey(f2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拿到公钥e2</span></span><br><span class="line">e2 = <span class="built_in">int</span>(pub2.e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;cipher1.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c1 = f.read()</span><br><span class="line"><span class="comment"># 得到密文c1</span></span><br><span class="line">c1 = bytes_to_long(c1)</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;cipher2.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    c2 = f.read()</span><br><span class="line"><span class="comment"># 得到密文c2</span></span><br><span class="line">c2 = bytes_to_long(c2)</span><br><span class="line"><span class="built_in">print</span>(c2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到扩展欧几里得中的计算模系数</span></span><br><span class="line">s = egcd(e1, e2)</span><br><span class="line"></span><br><span class="line">s1 = s[<span class="number">1</span>]</span><br><span class="line">s2 = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 避免负指数运算</span></span><br><span class="line"><span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">    s1 = -s1</span><br><span class="line">    c1 = invert(c1, n)</span><br><span class="line"><span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">    s2 = -s2</span><br><span class="line">    c2 = invert(c2, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">m = <span class="built_in">pow</span>(c1, s1, n) * <span class="built_in">pow</span>(c2, s2, n) % n</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m).decode())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="3、注意-9"><a href="#3、注意-9" class="headerlink" title="3、注意"></a>3、注意</h3><p>注意几种常见rsa攻击的脚本</p>
<h2 id="十三、shanghai"><a href="#十三、shanghai" class="headerlink" title="十三、shanghai"></a>十三、shanghai</h2><blockquote>
<p>题目:打开是一个文本文件</p>
</blockquote>
<h3 id="1、知识补充-11"><a href="#1、知识补充-11" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>维吉尼亚密码：</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633872/my_blog/CTF/Crypto_attackworld_s_1/15_b6qxuo.png" alt="img"></p>
<p>例如，假设明文为：<br>ATTACKATDAWN<br>选择某一关键词并重复而得到密钥，如关键词为LEMON时，密钥为：<br>LEMONLEMONLE<br>对于明文的第一个字母A，对应密钥的第一个字母L，于是使用表格中L行字母表进行加密，得到密文第一个字母L。类似地，明文第二个字母为T，在表格中使用对应的E行进行加密，得到密文第二个字母X。以此类推，可以得到：<br>明文：ATTACKATDAWN密钥：LEMONLEMONLE密文：LXFOPVEFRNHR<br>解密的过程则与加密相反。例如：根据密钥第一个字母L所对应的L行字母表，发现密文第一个字母L位于A列，因而明文第一个字母为A。密钥第二个字母E对应E行字母表，而密文第二个字母X位于此行T列，因而明文第二个字母为T。以此类推便可得到明文。</p>
<h3 id="2、解答-10"><a href="#2、解答-10" class="headerlink" title="2、解答"></a>2、解答</h3><p>题目提示为维吉尼亚密码，首先浏览文本，发现疑似flag的部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jtcw, &#x27;&#123;&#x27; vvj &#x27;zvkvrmtudabiecveaaxpp&#x27; grq &#x27;&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>接下来就是找密钥</p>
<p>看文章：</p>
<p><strong>（1）大体猜测密钥</strong></p>
<p>文段里出现许多四位数字，显然是年份，那么在数字前面若是两个字母组成的单词，不难想到，就是“in”。比如第一段，有 “mv 1580”，第三段 “qp 1586”、第四段 “qp 1917”。</p>
<p>mv – ei qp – ic</p>
<p>注意到第五段的数字 “frxnimp 1914 qil 1940” ，像这种结构，不难想到是“between and”型。 frxnimp - between</p>
<p>qil - and 对此进行推算密钥。</p>
<p>frxnimp – enereic qil – qvi 因为between and 是连在一起的，那么现在已知的大致为 enereicqvi 顺序未定。</p>
<p><strong>（2）确定长度</strong></p>
<p>如何确定长度？最简单的办法，就是寻找相同长度的单词并且单词字母完全一致。</p>
<p>如：第四段最后一行 “opk gvtyiz kd opk 16xu gvrbwht.[6]” 。opk与opk，之间相差11，即为密钥长度。</p>
<p>由加密原理可知，改变的是偏移值，其单词长度不会发生改变。并且若加密结果相等，证明密钥恰好一致。间隔便为其密钥之长。 但我们手上掌握的却只有10位，因此，得继续寻找。</p>
<p>可以继续看这段话。 “16xu” 很像 “16th” 并且“opk”极有可能是“the”。来尝试一下</p>
<p>opk – vig xu – en 这样。密钥产生：enereicqvig （顺序未定）。<br><strong>（3）确定密钥</strong></p>
<p>1、来看第一段第一个单词。开头三个字母，可大致猜是 the ，推算一下 密钥： icq 。 恰好吻合。则真正的密钥便为： icqvigenere</p>
<p>将密钥和原文一并放入解密工具，产生原文。 解密网站<a target="_blank" rel="noopener" href="http://www.hiencode.com/vigenere.html">CTF在线工具-在线维吉尼亚密码加密|在线维吉尼亚解密|维吉尼亚密码算法|Vigenere Cipher (hiencode.com)</a></p>
<p>然后在原文中查找。</p>
<p>2、在倒数第三段存在这样语句 ： jtcw, ‘{’ vvj ‘zvkvrmtudabiecveaaxpp’ grq ‘}’ 显然这就是 被加密的flag jtcw对用的就是flag。 那么用它推算一下：</p>
<p>jtcw – eicq 则直接对 jtcw, ‘{’ vvj ‘zvkvrmtudabiecveaaxpp’ grq ‘}’ 解密 。 密钥为：eicqvigener<br><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633872/my_blog/CTF/Crypto_attackworld_s_1/16_xuiyqg.png" alt="image-20220407200553642"></p>
<h3 id="3、注意-10"><a href="#3、注意-10" class="headerlink" title="3、注意"></a>3、注意</h3><p>理解维吉尼亚密码的加密方式，和密钥的猜测</p>
<h2 id="十四、RSA-gcd"><a href="#十四、RSA-gcd" class="headerlink" title="十四、RSA_gcd"></a>十四、RSA_gcd</h2><blockquote>
<p>题目:解压后时两个attach，有两个nce,且e相同</p>
</blockquote>
<h3 id="1、知识补充-12"><a href="#1、知识补充-12" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>暂无</p>
<h3 id="2、解答-11"><a href="#2、解答-11" class="headerlink" title="2、解答"></a>2、解答</h3><p>正常的RSA解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_p</span>(<span class="params">n1, n2</span>):</span><br><span class="line">    p = gmpy2.gcd(n1, n2)</span><br><span class="line">    <span class="keyword">assert</span> gmpy2.is_prime(p) == <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_str</span>(<span class="params">data</span>):</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> data:</span><br><span class="line">        flag += <span class="built_in">chr</span>(data &amp; <span class="number">0xff</span>)</span><br><span class="line">        data &gt;&gt;= <span class="number">8</span></span><br><span class="line">    <span class="keyword">return</span> flag[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n1 = <span class="number">23220619839642624127208804329329079289273497927351564011985292026254914394833691542552890810511751239656361686073628273309390314881604580204429708461587512500636158161303419916259271078173864800267063540526943181173708108324471815782985626723198144643256432774984884880698594364583949485749575467318173034467846143380574145455195152793742611717169602237969286580028662721065495380192815175057945420182742366791661416822623915523868590710387635935179876275147056396018527260488459333051132720558953142984038635223793992651637708150494964785475065404568844039983381403909341302098773533325080910057845573898984314246089</span></span><br><span class="line">    n2 = <span class="number">22642739016943309717184794898017950186520467348317322177556419830195164079827782890660385734113396507640392461790899249329899658620250506845740531699023854206947331021605746078358967885852989786535093914459120629747240179425838485974008209140597947135295304382318570454491064938082423309363452665886141604328435366646426917928023608108470382196753292656828513681562077468846105122812084765257799070754405638149508107463233633350462138751758913036373169668828888213323429656344812014480962916088695910177763839393954730732312224100718431146133548897031060554005592930347226526561939922660855047026581292571487960929911</span></span><br><span class="line">    c1 = <span class="number">9700614748413503291260966231863562117502096284616216707445276355274869086619796527618473213422509996843430296526594113572675840559345077344419098900818709577642324900405582499683604786981144099878021784567540654040833912063141709913653416394888766281465200682852378794478801329251224801006820925858507273130504236563822120838520746270280731121442839412258397191963036040553539697846535038841541209050503061001070909725806574230090246041891486506980939294245537252610944799573920844235221096956391095716111629998594075762507345430945523492775915790828078000453705320783486744734994213028476446922815870053311973844961</span></span><br><span class="line">    c2 = <span class="number">20513108670823938405207629835395350087127287494963553421797351726233221750526355985253069487753150978011340115173042210284965521215128799369083065796356395285905154260709263197195828765397189267866348946188652752076472172155755940282615212228370367042435203584159326078238921502151083768908742480756781277358357734545694917591921150127540286087770229112383605858821811640935475859936319249757754722093551370392083736485637225052738864742947137890363135709796410008845576985297696922681043649916650599349320818901512835007050425460872675857974069927846620905981374869166202896905600343223640296138423898703137236463508</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    p = get_p(n1, n2)</span><br><span class="line">    q1 = n1 // p</span><br><span class="line">    q2 = n2 // p</span><br><span class="line">    d1 = gmpy2.invert(e, (p - <span class="number">1</span>) * (q1 - <span class="number">1</span>))</span><br><span class="line">    d2 = gmpy2.invert(e, (p - <span class="number">1</span>) * (q2 - <span class="number">1</span>))</span><br><span class="line">    m1 = gmpy2.powmod(c1, d1, n1)</span><br><span class="line">    m2 = gmpy2.powmod(c2, d2, n2)</span><br><span class="line">    <span class="built_in">print</span>(int_str(m1) + int_str(m2))</span><br></pre></td></tr></table></figure>
<h3 id="3、注意-11"><a href="#3、注意-11" class="headerlink" title="3、注意"></a>3、注意</h3><p>暂无</p>
<h2 id="十五、equation-2"><a href="#十五、equation-2" class="headerlink" title="十五、equation-2"></a>十五、equation-2</h2><blockquote>
<p>题目：Here is a RSA private key with its upper part masked. Can your recover the private key and decrypt the file?</p>
</blockquote>
<h3 id="1、知识补充-13"><a href="#1、知识补充-13" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>私钥信息按如下顺序排列：<br>version | pad | n | pad | e | pad | d | pad | p | pad | q | pad | x1 | pad | x2 | pad | x3<br>其中，pad是填充信息，各pad并不同，x1=d mod (p−1),x2=d mod (q−1),x3=p−1 mod qx1=d mod (p−1),x2=d mod (q−1),x3=p−1 mod q，填充pad用来注释接下来的大数的(字节)长度，\x02为pad开头的标记，有时后面接\x81或\x82，这用来标记长度值所占用的字节(\x81代表占用1个字节，\x82代表占用2个字节)，有时后面不接\x81或\x82而直接放置长度；<br>例：\x02\x03代表接下来的大数的字节长度为3个字节；\x02\x81\x80，首先，\x81代表长度占用1个字节，因此\x80就是长度值，即128，表明接下来的大数的字节长度为128个字节。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/Zhymax/article/details/7683925?ops_request_misc=%7B%22request%5Fid%22%3A%22164933609516782246494414%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=164933609516782246494414&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-7683925.142^v7^article_score_rank,157^v4^control&amp;utm_term=OpenSSL私钥结构&amp;spm=1018.2226.3001.4187">使用openssl命令剖析RSA私钥文件格式_Zhymax的博客-CSDN博客_rsa私钥格式</a></p>
<h3 id="2、解答-12"><a href="#2、解答-12" class="headerlink" title="2、解答"></a>2、解答</h3><p>截图可见编码为（可用qq识字）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Os9mhOQRdqW2cwVrnNI72DLcAXpXUJ1HGwJBANWiJcDUGxZpnERxVw7s0913WXNtV4GqdxCzG0pG5EHThtoTRbyX0aqRP4U/hQ9tRoSoDmBn+3HPITsnbCy67VkCQBM4xZPTtUKM6Xi+16VTUnFVs9E4rqwIQCDAxn9UuVMBXlX2Cl0xOGUF4C5hItrX2woF7LVS5EizR63CyRcPovMCQQDVyNbcWD7N88MhZjujKuSrHJot7WcCaRmTGEIJ6TkU8NWt9BVjR4jVkZ2EqNd0KZWdQPukeynPcLlDEkIXyaQx</span><br></pre></td></tr></table></figure>
<p>base64脚本解码后解出x1,x2,x3</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, inverse</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"></span><br><span class="line">s =<span class="string">&#x27;Os9mhOQRdqW2cwVrnNI72DLcAXpXUJ1HGwJBANWiJcDUGxZpnERxVw7s0913WXNtV4GqdxCzG0pG5EHThtoTRbyX0aqRP4U/hQ9tRoSoDmBn+3HPITsnbCy67VkCQBM4xZPTtUKM6Xi+16VTUnFVs9E4rqwIQCDAxn9UuVMBXlX2Cl0xOGUF4C5hItrX2woF7LVS5EizR63CyRcPovMCQQDVyNbcWD7N88MhZjujKuSrHJot7WcCaRmTGEIJ6TkU8NWt9BVjR4jVkZ2EqNd0KZWdQPukeynPcLlDEkIXyaQx&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(s.encode(<span class="string">&#x27;utf8&#x27;</span>)))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\xcff\x84\xe4\x11v\xa5\xb6s\x05k\x9c\xd2;\xd82\xdc\x01zWP\x9dG\x1b</span><br><span class="line">\x02A\x00\xd5\xa2%\xc0\xd4\x1b\x16i\x9cDqW\x0e\xec\xd3\xddwYsmW\x81\xaaw\x10\xb3\x1bJF\xe4A\xd3\x86\xda\x13E\xbc\x97\xd1\xaa\x91?\x85?\x85\x0fmF\x84\xa8\x0e`g\xfbq\xcf!;\&#x27;l,\xba\xedY</span><br><span class="line">\x02@\x138\xc5\x93\xd3\xb5B\x8c\xe9x\xbe\xd7\xa5SRqU\xb3\xd18\xae\xac\x08@ \xc0\xc6\x7fT\xb9S\x01^U\xf6\n]18e\x05\xe0.a&quot;\xda\xd7\xdb\n\x05\xec\xb5R\xe4H\xb3G\xad\xc2\xc9\x17\x0f\xa2\xf3</span><br><span class="line">\x02A\x00\xd5\xc8\xd6\xdcX&gt;\xcd\xf3\xc3!f;\xa3*\xe4\xab\x1c\x9a-\xedg\x02i\x19\x93\x18B\t\xe99\x14\xf0\xd5\xad\xf4\x15cG\x88\xd5\x91\x9d\x84\xa8\xd7t)\x95\x9d@\xfb\xa4&#123;)\xcfp\xb9C\x12B\x17\xc9\xa41</span><br></pre></td></tr></table></figure>
<p>解码后结合OpenSSL私钥结构分析可得：x1,x2,x3为已知；但是仅有x1,x2,x3并不能恢复出p,q与d，若我们假设e为常用的指数3,65537等等，则可试出p与q：</p>
<p>d⋅e≡1 mod (p−1)(q−1)d⋅e≡1 mod (p−1)(q−1)<br>则有d⋅e≡1 mod (p−1)d⋅e≡1 mod (p−1)与d⋅e≡1 mod (q−1)d⋅e≡1 mod (q−1)；<br>由x1x1与x2x2的定义可得x1⋅e≡1 mod (p−1)x1⋅e≡1 mod (p−1)，x2⋅e≡1 mod (q−1)x2⋅e≡1 mod (q−1)；<br>因此(p−1)|(x1⋅e−1)(p−1)|(x1⋅e−1)；<br>记x1⋅e−1=r1⋅(p−1)x1⋅e−1=r1⋅(p−1)；<br>由于x1=d mod (p−1)x1=d mod (p−1)，则x1&lt;(p−1)x1&lt;(p−1)；<br>几乎可以看做x1⋅e=r1⋅(p−1)x1⋅e=r1⋅(p−1)，那么必有r1&lt;er1&lt;e；<br>同理可得r2&lt;er2&lt;e，其中x2⋅e−1=r2⋅(q−1)x2⋅e−1=r2⋅(q−1)<br>可以看到，ri&lt;e,i=1,2ri&lt;e,i=1,2，从而可使用试除法求出ri,i=1,2ri,i=1,2；<br>则p=(x1⋅e−1)/r1+1,q=(x2⋅e−1)/r2+1p=(x1⋅e−1)/r1+1,q=(x2⋅e−1)/r2+1；</p>
<p>解答脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, inverse</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_to_int</span>(<span class="params">x</span>):</span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> data <span class="keyword">in</span> x:</span><br><span class="line">        ans &lt;&lt;= <span class="number">8</span></span><br><span class="line">        ans += <span class="built_in">ord</span>(data)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">x1 = bytes_to_int(<span class="string">&#x27;\xd5\xa2%\xc0\xd4\x1b\x16i\x9cDqW\x0e\xec\xd3\xddwYsmW\x81\xaaw\x10\xb3\x1bJF\xe4A\xd3\x86\xda\x13E\xbc\x97\xd1\xaa\x91?\x85?\x85\x0fmF\x84\xa8\x0e`g\xfbq\xcf!;\&#x27;l,\xba\xedY&#x27;</span>)</span><br><span class="line">x2 = bytes_to_int(<span class="string">&#x27;\x138\xc5\x93\xd3\xb5B\x8c\xe9x\xbe\xd7\xa5SRqU\xb3\xd18\xae\xac\x08@ \xc0\xc6\x7fT\xb9S\x01^U\xf6\n]18e\x05\xe0.a&quot;\xda\xd7\xdb\n\x05\xec\xb5R\xe4H\xb3G\xad\xc2\xc9\x17\x0f\xa2\xf3&#x27;</span>)</span><br><span class="line">x3 = bytes_to_int(<span class="string">&#x27;\xd5\xc8\xd6\xdcX&gt;\xcd\xf3\xc3!f;\xa3*\xe4\xab\x1c\x9a-\xedg\x02i\x19\x93\x18B\t\xe99\x14\xf0\xd5\xad\xf4\x15cG\x88\xd5\x91\x9d\x84\xa8\xd7t)\x95\x9d@\xfb\xa4&#123;)\xcfp\xb9C\x12B\x17\xc9\xa41&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>(<span class="params">x1, x2, x3</span>):</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    n1 = x1 * e - <span class="number">1</span></span><br><span class="line">    n2 = x2 * e - <span class="number">1</span></span><br><span class="line">    p = <span class="number">0</span>; q = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 尝试求 r1</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(e - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n1 % r == <span class="number">0</span>:</span><br><span class="line">            p = (n1 // r) + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> gmpy2.is_prime(p):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 尝试求 r2</span></span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(e - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n2 % r == <span class="number">0</span>:</span><br><span class="line">            q = (n2 // r) + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> gmpy2.is_prime(q):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    <span class="keyword">assert</span> inverse(q, p) == x3</span><br><span class="line">    <span class="keyword">return</span> RSA.construct((n, e, <span class="built_in">int</span>(d), p, q))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    rsa_key = genKey(x1, x2, x3)</span><br><span class="line">    key = PKCS1_v1_5.new(rsa_key)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        <span class="keyword">return</span> key.decrypt(fp.read(), <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(solve()) </span><br></pre></td></tr></table></figure>
<h3 id="3、注意-12"><a href="#3、注意-12" class="headerlink" title="3、注意"></a>3、注意</h3><p>OpenSSL私钥结构分析！！！！</p>
<h2 id="十六、streamgame2"><a href="#十六、streamgame2" class="headerlink" title="十六、streamgame2"></a>十六、streamgame2</h2><blockquote>
<p>题目：解压后一个key，一个.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">27</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line"> output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span></span><br><span class="line"> i=(R&amp;mask)&amp;<span class="number">0xffffff</span></span><br><span class="line"> lastbit=<span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">     lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">     i=i&gt;&gt;<span class="number">1</span></span><br><span class="line"> output^=lastbit</span><br><span class="line"> <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R=<span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">mask=<span class="number">0x100002</span></span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;ab&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line"> tmp=<span class="number">0</span></span><br><span class="line"> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">     (R,out)=lfsr(R,mask)</span><br><span class="line">     tmp=(tmp &lt;&lt; <span class="number">1</span>)^out</span><br><span class="line"> f.write(<span class="built_in">chr</span>(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="1、知识补充-14"><a href="#1、知识补充-14" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>线性反馈移位寄存器（LFSR）归属于移位寄存器（FSR）,除此之外还有非线性移位寄存器（NFSR）。移位寄存器是流密码产生密钥流的一个主要组成部分。</p>
<p>上一个n级反馈移位寄存器由n个二元存储器与一个反馈函数组成，如下图所示。</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633872/my_blog/CTF/Crypto_attackworld_s_1/17_djxqsv.png" alt></p>
<p>移位寄存器的三要素：</p>
<ul>
<li><p>初始状态：由用户确定</p>
</li>
<li><p>反馈函数：是n元布尔函数，即函数的自变量和因变量只取0和1这两个可能值</p>
</li>
<li><p>输出序列</p>
</li>
</ul>
<p>如果反馈函数是线性的，那么我们称其为 LFSR,如下图所示：</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633873/my_blog/CTF/Crypto_attackworld_s_1/18_v60dch.png" alt></p>
<p>LFSR的输出序列{ }满足:</p>
<p>…..</p>
<p>(i = 1,2,3,…)</p>
<p>举例：</p>
<p>下面是一个5级的线性反馈移位寄存器，其初始状态为</p>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633873/my_blog/CTF/Crypto_attackworld_s_1/19_vesdye.png" alt></p>
<p>反馈函数为：，(i = 1,2,…) 可以得到输出序列为：</p>
<p>1001101001000010101110110001111 100110…</p>
<p>周期为31。</p>
<p>对于 n 级线性反馈移位寄存器，最长周期为（排除全零）。达到最长周期的序列一般称为 m 序列</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38154820/article/details/115222774?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.pc_relevant_default&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=3">CTF竞赛密码学 之 LFSR_合天网安实验室的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiao__1bai/article/details/120392307?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~Rate-1.pc_relevant_default&amp;utm_relevant_index=1">CTF中的LFSR考点(一)_沐一 · 林的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44370676/article/details/109067035?ops_request_misc=%7B%22request%5Fid%22%3A%22164942102316782089373033%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=164942102316782089373033&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-109067035.142^v7^article_score_rank,157^v4^control&amp;utm_term=streamgame&amp;spm=1018.2226.3001.4187">攻防世界streamgame1_I still …的博客-CSDN博客</a></p>
<h3 id="2、解答-13"><a href="#2、解答-13" class="headerlink" title="2、解答"></a>2、解答</h3><p>爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">bin_out = <span class="built_in">open</span>(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">key = <span class="built_in">bin</span>(bytes_to_long(bin_out))[<span class="number">2</span>:]</span><br><span class="line"><span class="comment"># print(key[0:21])</span></span><br><span class="line"><span class="comment"># print(bin(int(&#x27;0x100002&#x27;,16)))</span></span><br><span class="line">key = <span class="string">&#x27;101100101110100100001&#x27;</span></span><br><span class="line">mask= <span class="string">&#x27;100000000000000000010&#x27;</span></span><br><span class="line"></span><br><span class="line">tmp = key</span><br><span class="line">R = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>):</span><br><span class="line">    output = <span class="string">&#x27;?&#x27;</span> + key[:<span class="number">20</span>]</span><br><span class="line">    ans = <span class="built_in">int</span>(tmp[-<span class="number">1</span>-i]) ^ <span class="built_in">int</span>(output[-<span class="number">2</span>])</span><br><span class="line">    R += <span class="built_in">str</span>(ans)</span><br><span class="line">    key = <span class="built_in">str</span>(ans) + key[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(R[::-<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<h3 id="3、注意-13"><a href="#3、注意-13" class="headerlink" title="3、注意"></a>3、注意</h3><p>爆破和逆运算2种思路，还<strong>未全部理解</strong></p>
<h2 id="十七、streamgame1"><a href="#十七、streamgame1" class="headerlink" title="十七、streamgame1"></a>十七、streamgame1</h2><blockquote>
<p>题目：解压后一个key，一个.py文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line"><span class="comment"># 作用：判断字符串是否以指定字符或子字符串开头flag&#123;</span></span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># 作用：判断字符串是否以指定字符或子字符串结尾&#125;，flag&#123;&#125;，6个字节</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">25</span></span><br><span class="line"><span class="comment"># flag的长度为25字节，25-6=19个字节</span></span><br><span class="line"><span class="comment">#3&lt;&lt;2可以这么算，bin(3)=0b11向左移动2位变成1100，0b1100=12(十进制)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line"> output = (R &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span>    <span class="comment">#将R向左移动1位，bin(0xffffff)=&#x27;0b111111111111111111111111&#x27;=0xffffff的二进制补码</span></span><br><span class="line"> i=(R&amp;mask)&amp;<span class="number">0xffffff</span>             <span class="comment">#按位与运算符&amp;：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0</span></span><br><span class="line"> lastbit=<span class="number">0</span></span><br><span class="line"> <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">     lastbit^=(i&amp;<span class="number">1</span>)    <span class="comment">#按位异或运算符：当两对应的二进位相异时，结果为1</span></span><br><span class="line">     i=i&gt;&gt;<span class="number">1</span></span><br><span class="line"> output^=lastbit</span><br><span class="line"> <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R=<span class="built_in">int</span>(flag[<span class="number">5</span>:-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">mask    =   <span class="number">0b1010011000100011100</span></span><br><span class="line"></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;ab&quot;</span>)   <span class="comment">#以二进制追加模式打开</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line"> tmp=<span class="number">0</span></span><br><span class="line"> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">     (R,out)=lfsr(R,mask)</span><br><span class="line">     tmp=(tmp &lt;&lt; <span class="number">1</span>)^out   <span class="comment">#按位异或运算符：当两对应的二进位相异时，结果为1</span></span><br><span class="line"> f.write(<span class="built_in">chr</span>(tmp))  <span class="comment">#chr() 用一个范围在 range（256）内的（就是0～255）整数作参数，返回一个对应的字符。</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="1、知识补充-15"><a href="#1、知识补充-15" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>见streamgame2</p>
<h3 id="2、解答-14"><a href="#2、解答-14" class="headerlink" title="2、解答"></a>2、解答</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp;<span class="number">0xffffff</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"> </span><br><span class="line">key=[<span class="number">85</span>,<span class="number">56</span>,<span class="number">247</span>,<span class="number">66</span>,<span class="number">193</span>,<span class="number">13</span>,<span class="number">178</span>,<span class="number">199</span>,<span class="number">237</span>,<span class="number">224</span>,<span class="number">36</span>,<span class="number">58</span>]</span><br><span class="line">mask=<span class="number">0b1010011000100011100</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">19</span>):</span><br><span class="line">    R=k;</span><br><span class="line">    a=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    judge=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            (k, out) = lfsr(k, mask)</span><br><span class="line">            tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">        <span class="keyword">if</span>(key[i]!=tmp):</span><br><span class="line">           judge=<span class="number">0</span></span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(judge==<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bin</span>(R)[<span class="number">2</span>:]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="3、注意-14"><a href="#3、注意-14" class="headerlink" title="3、注意"></a>3、注意</h3><p>注意原理理解</p>
<h2 id="十八、wtc-rsa-bbq"><a href="#十八、wtc-rsa-bbq" class="headerlink" title="十八、wtc_rsa_bbq"></a>十八、wtc_rsa_bbq</h2><blockquote>
<p>题目：解压后，一个cipher.bin、一个key.pem文件</p>
</blockquote>
<h3 id="1、知识补充-16"><a href="#1、知识补充-16" class="headerlink" title="1、知识补充"></a>1、知识补充</h3><p>JPEG (jpg)，文件头：FFD8FF<br>PNG (png)，文件头：89504E47<br>GIF (gif)，文件头：47494638<br>TIFF (tif)，文件头：49492A00<br>Windows Bitmap (bmp)，文件头：424D<br>CAD (dwg)，文件头：41433130<br>Adobe Photoshop (psd)，文件头：38425053<br>Rich Text Format (rtf)，文件头：7B5C727466<br>XML (xml)，文件头：3C3F786D6C<br>HTML (html)，文件头：68746D6C3E<br>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A<br>Outlook Express (dbx)，文件头：CFAD12FEC5FD746F<br>Outlook (pst)，文件头：2142444E<br>MS Word/Excel (xls.or.doc)，文件头：D0CF11E0<br>MS Access (mdb)，文件头：5374616E64617264204A<br>WordPerfect (wpd)，文件头：FF575043<br>Postscript (eps.or.ps)，文件头：252150532D41646F6265<br>Adobe Acrobat (pdf)，文件头：255044462D312E<br>Quicken (qdf)，文件头：AC9EBD8F<br>Windows Password (pwl)，文件头：E3828596<br>ZIP Archive (zip)，文件头：504B0304<br>RAR Archive (rar)，文件头：52617221<br>Wave (wav)，文件头：57415645<br>AVI (avi)，文件头：41564920<br>Real Audio (ram)，文件头：2E7261FD<br>Real Media (rm)，文件头：2E524D46<br>MPEG (mpg)，文件头：000001BA<br>MPEG (mpg)，文件头：000001B3<br>Quicktime (mov)，文件头：6D6F6F76<br>Windows Media (asf)，文件头：3026B2758E66CF11<br>MIDI (mid)，文件头：4D546864</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mq0036/p/3912355.html">根据文件头数据判断文件类型 - jack_Meng - 博客园 (cnblogs.com)</a></p>
<h3 id="2、解答-15"><a href="#2、解答-15" class="headerlink" title="2、解答"></a>2、解答</h3><p>一开始不知道是啥文件，放到winhex中看，是504B03开头（PK开头），得知是压缩文件，改后缀后解压，一个cipher.bin、一个key.pem文件</p>
<p>使用openssl查看公钥信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsa -pubin -in key.pem -text -modulus</span><br></pre></td></tr></table></figure>
<p>发现模数很大，8587位；本来分解模数丢到yafu里面分解就行，但是几个小时都没有分解出来，去<a target="_blank" rel="noopener" href="http://factordb.com/">factordb</a>也分解不出来；回顾针对RSA的各种攻击，对本题可以使用的剩下Small q,费马分解(p与q接近)，试着用费马分解时分解成功。</p>
<p>使用 RSACTFTOOL，将key.pem与cipher.bin移到与RsaCtfTool.py同目录下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo python3 RsaCtfTool.py --publickey key.pem --uncipherfile cipher.bin --attack fermat</span><br></pre></td></tr></table></figure>
<p><img src="https://res.cloudinary.com/yanmo312/image/upload/v1662633874/my_blog/CTF/Crypto_attackworld_s_1/20_xofsf9.png" alt="image-20220408210456005"></p>
<h3 id="3、注意-15"><a href="#3、注意-15" class="headerlink" title="3、注意"></a>3、注意</h3><p>善用linux中的ctf工具</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Yanmo312</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://yanmo312.github.io/2022/03/22/Crypto_2/">https://yanmo312.github.io/2022/03/22/Crypto_2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><div class="post_share"><div class="social-share" data-image="/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2022/03/22/Crypto_1/"><img class="prev-cover" src="/img/default.jpg" onerror="onerror=null;src='/img/default.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">AW-crypto_j</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/03/22/Crypto_1/" title="AW-crypto_j"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-22</div><div class="title">AW-crypto_j</div></div></a></div><div><a href="/2022/11/17/gemima_3/" title="Lattice Based Crypto_3"><img class="cover" src="/img/category.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">Lattice Based Crypto_3</div></div></a></div><div><a href="/2022/11/17/gemima_1/" title="Lattice Based Crypto_1"><img class="cover" src="/img/category.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">Lattice Based Crypto_1</div></div></a></div><div><a href="/2022/11/17/gemima_4/" title="Lattice Based Crypto_4"><img class="cover" src="/img/category.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">Lattice Based Crypto_4</div></div></a></div><div><a href="/2022/11/17/gemima_2/" title="Lattice Based Crypto_2"><img class="cover" src="/img/category.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-17</div><div class="title">Lattice Based Crypto_2</div></div></a></div><div><a href="/2022/11/18/gemima_5/" title="Lattice Based Crypto_5"><img class="cover" src="/img/category.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-18</div><div class="title">Lattice Based Crypto_5</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yanmo312</div><div class="author-info__description">a blog for studying and playing :)</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yanmo312"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Yanmo312" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1211274465@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">Keep holding on !!!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-crypto"><span class="toc-number">1.</span> <span class="toc-text">攻防世界-crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81sherlock"><span class="toc-number">1.1.</span> <span class="toc-text">一、sherlock</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、知识补充</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%A0%E9%99%A4SET1%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%EF%BC%8C%E4%B8%8D%E8%BF%9B%E8%A1%8C%E7%BF%BB%E8%AF%91"><span class="toc-number">2.</span> <span class="toc-text">删除SET1中的字符，不进行翻译</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94"><span class="toc-number">2.0.1.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F"><span class="toc-number">2.0.2.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81flag-in-your-hand"><span class="toc-number">2.1.</span> <span class="toc-text">二、flag_in_your_hand</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-1"><span class="toc-number">2.1.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-1"><span class="toc-number">2.1.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-1"><span class="toc-number">2.1.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%91%8A%E8%AF%89%E4%BD%A0%E4%B8%AA%E7%A7%98%E5%AF%86"><span class="toc-number">2.2.</span> <span class="toc-text">三、告诉你个秘密</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-2"><span class="toc-number">2.2.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-2"><span class="toc-number">2.2.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-2"><span class="toc-number">2.2.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E4%BD%A0%E7%8C%9C%E7%8C%9C"><span class="toc-number">2.3.</span> <span class="toc-text">四、你猜猜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-3"><span class="toc-number">2.3.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-3"><span class="toc-number">2.3.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-3"><span class="toc-number">2.3.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81Broadcast"><span class="toc-number">2.4.</span> <span class="toc-text">五、Broadcast</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-4"><span class="toc-number">2.4.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-4"><span class="toc-number">2.4.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-4"><span class="toc-number">2.4.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%B7%A5%E4%B8%9A%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%902"><span class="toc-number">2.5.</span> <span class="toc-text">六、工业协议分析2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-5"><span class="toc-number">2.5.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-5"><span class="toc-number">2.5.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-5"><span class="toc-number">2.5.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81cr3-what-is-this-encryption"><span class="toc-number">2.6.</span> <span class="toc-text">七、cr3-what-is-this-encryption</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-6"><span class="toc-number">2.6.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-6"><span class="toc-number">2.6.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-6"><span class="toc-number">2.6.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81banana-princess"><span class="toc-number">2.7.</span> <span class="toc-text">八、banana-princess</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-7"><span class="toc-number">2.7.1.</span> <span class="toc-text">1、知识补充</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81flag-in-your-hand1"><span class="toc-number">2.8.</span> <span class="toc-text">九、flag_in_your_hand1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81Decrypt-the-Message"><span class="toc-number">2.9.</span> <span class="toc-text">十、Decrypt-the-Message</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-8"><span class="toc-number">2.9.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-7"><span class="toc-number">2.9.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-7"><span class="toc-number">2.9.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81OldDriver"><span class="toc-number">2.10.</span> <span class="toc-text">十一、OldDriver</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-9"><span class="toc-number">2.10.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-8"><span class="toc-number">2.10.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-8"><span class="toc-number">2.10.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81best-rsa"><span class="toc-number">2.11.</span> <span class="toc-text">十二、best_rsa</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-10"><span class="toc-number">2.11.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-9"><span class="toc-number">2.11.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-9"><span class="toc-number">2.11.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81shanghai"><span class="toc-number">2.12.</span> <span class="toc-text">十三、shanghai</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-11"><span class="toc-number">2.12.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-10"><span class="toc-number">2.12.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-10"><span class="toc-number">2.12.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81RSA-gcd"><span class="toc-number">2.13.</span> <span class="toc-text">十四、RSA_gcd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-12"><span class="toc-number">2.13.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-11"><span class="toc-number">2.13.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-11"><span class="toc-number">2.13.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81equation-2"><span class="toc-number">2.14.</span> <span class="toc-text">十五、equation-2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-13"><span class="toc-number">2.14.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-12"><span class="toc-number">2.14.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-12"><span class="toc-number">2.14.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E3%80%81streamgame2"><span class="toc-number">2.15.</span> <span class="toc-text">十六、streamgame2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-14"><span class="toc-number">2.15.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-13"><span class="toc-number">2.15.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-13"><span class="toc-number">2.15.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%83%E3%80%81streamgame1"><span class="toc-number">2.16.</span> <span class="toc-text">十七、streamgame1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-15"><span class="toc-number">2.16.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-14"><span class="toc-number">2.16.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-14"><span class="toc-number">2.16.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AB%E3%80%81wtc-rsa-bbq"><span class="toc-number">2.17.</span> <span class="toc-text">十八、wtc_rsa_bbq</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9F%A5%E8%AF%86%E8%A1%A5%E5%85%85-16"><span class="toc-number">2.17.1.</span> <span class="toc-text">1、知识补充</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E7%AD%94-15"><span class="toc-number">2.17.2.</span> <span class="toc-text">2、解答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B3%A8%E6%84%8F-15"><span class="toc-number">2.17.3.</span> <span class="toc-text">3、注意</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/17/Winter%20Vacation%20Plan/" title="Winter Vacation Plan"><img src="/img/default.jpg" onerror="this.onerror=null;this.src='/img/default.jpg'" alt="Winter Vacation Plan"/></a><div class="content"><a class="title" href="/2022/12/17/Winter%20Vacation%20Plan/" title="Winter Vacation Plan">Winter Vacation Plan</a><time datetime="2022-12-17T02:59:55.000Z" title="Created 2022-12-17 10:59:55">2022-12-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/26/gemima_6/" title="Lattice Based Crypto_6"><img src="/img/category.jpg" onerror="this.onerror=null;this.src='/img/default.jpg'" alt="Lattice Based Crypto_6"/></a><div class="content"><a class="title" href="/2022/11/26/gemima_6/" title="Lattice Based Crypto_6">Lattice Based Crypto_6</a><time datetime="2022-11-26T12:41:13.000Z" title="Created 2022-11-26 20:41:13">2022-11-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/18/gemima_5/" title="Lattice Based Crypto_5"><img src="/img/category.jpg" onerror="this.onerror=null;this.src='/img/default.jpg'" alt="Lattice Based Crypto_5"/></a><div class="content"><a class="title" href="/2022/11/18/gemima_5/" title="Lattice Based Crypto_5">Lattice Based Crypto_5</a><time datetime="2022-11-18T13:40:36.000Z" title="Created 2022-11-18 21:40:36">2022-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/18/Term_Plan_2_1_1/" title="Review Plan"><img src="/img/category.jpg" onerror="this.onerror=null;this.src='/img/default.jpg'" alt="Review Plan"/></a><div class="content"><a class="title" href="/2022/11/18/Term_Plan_2_1_1/" title="Review Plan">Review Plan</a><time datetime="2022-11-18T02:28:48.000Z" title="Created 2022-11-18 10:28:48">2022-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/17/gemima_3/" title="Lattice Based Crypto_3"><img src="/img/category.jpg" onerror="this.onerror=null;this.src='/img/default.jpg'" alt="Lattice Based Crypto_3"/></a><div class="content"><a class="title" href="/2022/11/17/gemima_3/" title="Lattice Based Crypto_3">Lattice Based Crypto_3</a><time datetime="2022-11-17T01:40:36.000Z" title="Created 2022-11-17 09:40:36">2022-11-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Yanmo312</div><div class="footer_custom_text">Keep quiet time for time</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/contrib/copy-tex.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script src="https://cdn.jsdelivr.net/gh/Yanmo312/Yanmo312.github.io/js/Plus.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>